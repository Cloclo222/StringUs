#ifndef __Scara_H__
#define __Scara_H__

#include <Dynamixel2Arduino.h>
#include "Arduino.h"

//Nos variables
#define moteur_gauche 1
#define moteur_droit 2
#define moteur_table 3
#define UP 180
#define DOWN 0
#define SCARA_SEQ_RES 50 // number of positions for circle sequence

using namespace ControlTableItem;
#define DXL_SERIAL   Serial1

class Scara
{
private:
    Dynamixel2Arduino &_dxl;
    const float DXL_PROTOCOL_VERSION = 2.0;
    int Pos_default[3] = {2560, 2560, 0};
    int Pos_current[3] = {0, 0, 0};
    int SpeedAccel[2] = {0, 0};
    
    

public:
    int range = 507; //(4096*nb_clous)/range
    int seqCalib[100][2];
<<<<<<< Updated upstream
    uint16_t LeftApproach[2];
    uint16_t RightApproach[2];
    uint16_t seqClou[2][50][2];
    //uint16_t LeftApproach[2] = {2825,1925};
    //uint16_t RightApproach[2] = {1952,2800};
//     uint16_t seqClou[2][100][2] = {{{2831, 1929},
// {2835, 1930},
// {2839, 1930},
// {2845, 1931},
// {2852, 1932},
// {2860, 1934},
// {2867, 1937},
// {2873, 1940},
// {2878, 1943},
// {2883, 1947},
// {2889, 1948},
// {2895, 1948},
// {2901, 1948},
// {2906, 1947},
// {2911, 1945},
// {2917, 1943},
// {2921, 1941},
// {2928, 1937},
// {2935, 1932},
// {2943, 1926},
// {2950, 1918},
// {2958, 1911},
// {2966, 1905},
// {2973, 1899},
// {2980, 1893},
// {2986, 1886},
// {2993, 1878},
// {2997, 1869},
// {2999, 1860},
// {2999, 1851},
// {2999, 1842},
// {2998, 1835},
// {2996, 1831},
// {2992, 1829},
// {2985, 1829},
// {2980, 1828},
// {2972, 1828},
// {2963, 1828},
// {2956, 1828},
// {2948, 1827},
// {2940, 1828},
// {2933, 1828},
// {2927, 1828},
// {2921, 1828},
// {2914, 1828},
// {2904, 1829},
// {2894, 1830},
// {2883, 1831},
// {2874, 1834},
// {2865, 1836},
// {2857, 1840},
// {2850, 1845},
// {2842, 1849},
// {2835, 1855},
// {2828, 1860},
// {2820, 1867},
// {2813, 1873},
// {2807, 1881},
// {2802, 1886},
// {2798, 1892},
// {2795, 1897},
// {2792, 1902},
// {2788, 1906},
// {2786, 1911},
// {2783, 1915},
// {2782, 1918},
// {2780, 1921},
// {2777, 1923},
// {2774, 1925},
// {2771, 1925},
// {2768, 1925},
// {2766, 1924},
// {2762, 1925},
// {2759, 1926},
// {2756, 1927},
// {2753, 1931},
// {2751, 1938},
// {2749, 1943},
// {2746, 1950},
// {2744, 1951},
// {2743, 1951},
// {2740, 1953},
// {2733, 1953},
// {2732, 1953},
// {2734, 1948},
// {2739, 1942},
// {2746, 1941},
// {2753, 1939},
// {2758, 1939},
// {2761, 1939},
// {2764, 1939},
// {2767, 1939},
// {2771, 1938},
// {2773, 1937},
// {2774, 1937},
// {2772, 1942},
// {2771, 1947},
// {2768, 1952},
// {2766, 1956},
// {2763, 1958}},
// {{1953, 2807},
// {1953, 2811},
// {1953, 2814},
// {1953, 2818},
// {1953, 2821},
// {1953, 2824},
// {1953, 2829},
// {1952, 2833},
// {1951, 2841},
// {1948, 2846},
// {1946, 2852},
// {1945, 2856},
// {1945, 2862},
// {1943, 2866},
// {1942, 2870},
// {1938, 2871},
// {1934, 2874},
// {1928, 2879},
// {1924, 2883},
// {1919, 2885},
// {1916, 2888},
// {1914, 2889},
// {1911, 2891},
// {1907, 2896},
// {1901, 2902},
// {1894, 2907},
// {1886, 2911},
// {1877, 2913},
// {1870, 2915},
// {1863, 2915},
// {1857, 2915},
// {1853, 2914},
// {1849, 2913},
// {1847, 2912},
// {1847, 2909},
// {1847, 2904},
// {1847, 2900},
// {1847, 2896},
// {1847, 2893},
// {1846, 2892},
// {1846, 2889},
// {1846, 2886},
// {1845, 2885},
// {1845, 2883},
// {1845, 2878},
// {1845, 2873},
// {1846, 2869},
// {1846, 2865},
// {1847, 2860},
// {1847, 2854},
// {1849, 2848},
// {1850, 2843},
// {1852, 2838},
// {1853, 2833},
// {1855, 2828},
// {1856, 2821},
// {1856, 2814},
// {1856, 2808},
// {1857, 2803},
// {1858, 2800},
// {1861, 2794},
// {1863, 2788},
// {1864, 2782},
// {1864, 2776},
// {1864, 2770},
// {1865, 2764},
// {1867, 2758},
// {1870, 2752},
// {1874, 2748},
// {1876, 2744},
// {1878, 2740},
// {1882, 2737},
// {1883, 2733},
// {1886, 2730},
// {1889, 2727},
// {1893, 2722},
// {1898, 2716},
// {1902, 2709},
// {1906, 2704},
// {1908, 2701},
// {1909, 2699},
// {1908, 2698},
// {1909, 2694},
// {1909, 2691},
// {1910, 2686},
// {1910, 2682},
// {1910, 2679},
// {1912, 2678},
// {1915, 2675},
// {1915, 2670},
// {1915, 2663},
// {1916, 2657},
// {1918, 2652},
// {1921, 2650},
// {1924, 2648},
// {1926, 2646},
// {1927, 2644},
// {1927, 2640},
// {1927, 2636},
// {1929, 2633}}}; 
=======
    int jointDefaultLeft[2] = {3244, 2378};
    int jointDefaultRight[2] = {2449,3125};
    int seqClou[2][100][2] = {{{3244, 2371},
{3244, 2367},
{3244, 2360},
{3244, 2354},
{3244, 2347},
{3244, 2342},
{3244, 2335},
{3244, 2328},
{3244, 2321},
{3244, 2313},
{3244, 2305},
{3245, 2298},
{3244, 2291},
{3244, 2286},
{3246, 2280},
{3247, 2275},
{3248, 2269},
{3250, 2263},
{3251, 2256},
{3254, 2250},
{3257, 2244},
{3260, 2240},
{3264, 2237},
{3267, 2234},
{3269, 2230},
{3271, 2224},
{3275, 2216},
{3278, 2208},
{3281, 2198},
{3284, 2189},
{3288, 2181},
{3291, 2175},
{3296, 2169},
{3302, 2164},
{3310, 2160},
{3318, 2156},
{3326, 2155},
{3333, 2158},
{3339, 2163},
{3343, 2169},
{3346, 2176},
{3347, 2183},
{3347, 2189},
{3347, 2195},
{3347, 2202},
{3347, 2207},
{3347, 2214},
{3347, 2220},
{3346, 2225},
{3344, 2229},
{3341, 2232},
{3337, 2235},
{3333, 2239},
{3328, 2243},
{3323, 2248},
{3317, 2251},
{3312, 2257},
{3308, 2263},
{3304, 2270},
{3301, 2278},
{3297, 2286},
{3293, 2291},
{3289, 2299},
{3284, 2307},
{3281, 2315},
{3277, 2324},
{3274, 2332},
{3271, 2341},
{3268, 2350},
{3263, 2361},
{3259, 2372},
{3254, 2385},
{3251, 2398},
{3247, 2412},
{3244, 2426},
{3241, 2438},
{3239, 2447},
{3237, 2454},
{3235, 2461},
{3235, 2469},
{3235, 2475},
{3235, 2480},
{3235, 2481},
{3235, 2475},
{3236, 2468},
{3236, 2460},
{3237, 2456},
{3237, 2453},
{3237, 2451},
{3237, 2447},
{3237, 2442},
{3237, 2441},
{3236, 2439},
{3237, 2438},
{3236, 2434},
{3237, 2431},
{3236, 2429},
{3235, 2433},
{3232, 2436},
{3227, 2437}},
{{2445, 3126},
{2441, 3127},
{2437, 3128},
{2435, 3128},
{2431, 3128},
{2426, 3128},
{2421, 3128},
{2415, 3129},
{2409, 3129},
{2404, 3131},
{2398, 3134},
{2393, 3137},
{2389, 3140},
{2385, 3143},
{2381, 3146},
{2376, 3148},
{2371, 3150},
{2366, 3151},
{2360, 3153},
{2356, 3155},
{2351, 3156},
{2347, 3158},
{2343, 3158},
{2339, 3159},
{2335, 3159},
{2331, 3161},
{2328, 3162},
{2324, 3163},
{2321, 3164},
{2316, 3164},
{2312, 3164},
{2309, 3164},
{2306, 3164},
{2302, 3165},
{2298, 3166},
{2294, 3168},
{2290, 3171},
{2287, 3175},
{2284, 3179},
{2280, 3182},
{2277, 3186},
{2274, 3190},
{2270, 3194},
{2267, 3198},
{2265, 3202},
{2262, 3206},
{2261, 3210},
{2261, 3215},
{2261, 3219},
{2261, 3222},
{2261, 3226},
{2263, 3227},
{2264, 3229},
{2268, 3228},
{2274, 3229},
{2279, 3229},
{2283, 3229},
{2286, 3229},
{2289, 3229},
{2293, 3228},
{2297, 3229},
{2302, 3229},
{2307, 3229},
{2312, 3229},
{2316, 3229},
{2319, 3227},
{2323, 3225},
{2327, 3223},
{2331, 3220},
{2337, 3217},
{2343, 3215},
{2349, 3210},
{2355, 3208},
{2361, 3205},
{2367, 3202},
{2373, 3199},
{2379, 3196},
{2383, 3192},
{2387, 3188},
{2391, 3183},
{2395, 3178},
{2399, 3173},
{2402, 3169},
{2406, 3165},
{2409, 3162},
{2412, 3159},
{2415, 3155},
{2417, 3153},
{2420, 3151},
{2422, 3149},
{2424, 3148},
{2427, 3146},
{2429, 3144},
{2432, 3142},
{2435, 3141},
{2438, 3138},
{2442, 3135},
{2446, 3132},
{2450, 3130},
{2453, 3128}}}; 
>>>>>>> Stashed changes
    Scara(Dynamixel2Arduino &dxl);
    ~Scara();
    void init_com();
    void init_moteur();
    void update();
    void setScaraPos(int jointPos[2]);
    void doSeq(int side);
    void setTablePos(int TablePos);
    void jointisPos(int jointPos[2]);
    void tableisPos(int TablePos);
    int* getLastCmd(); 
    float getDxlPos(int moteur);
    void toggleTorque(int i);
    void move(float cmd[2]);
    bool buildInvJacobienne();
    void printPosition();
    void sendDefaultPos();
    void setSpeed(uint8_t speedLimitRight, uint8_t speedLimitLeft);
    void setTableSpeed(uint8_t speedLimitTable);
    void setSpeedForLinearMov(int jointPos[2], uint8_t speedLimit);
    void setAcceleration(uint8_t AccelLimitBras, uint8_t AccelLimitTable);
    int* getSpeedAccel();
    void homing();

};

#endif //__SCARA_H__
